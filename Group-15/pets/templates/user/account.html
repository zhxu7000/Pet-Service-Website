{% extends 'base.html' %}

{% load static %}

{% block content %}
    <style>

        .weather-dashboard {
            display: flex;
            align-items: start;
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 10px;
            width: 650px;
            box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
            font-family: 'Nunito Sans', sans-serif;
        }

        .weather-info-container {
            flex: 1;
        }

        .dashboard-title {
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
        }

        .dashboard-meta {
            display: flex;
            flex-direction: column;
            align-items: start;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .weather-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .weather-icon img {
            width: 70px;
            height: 70px;
        }

        .weather-main-info .temperature {
            font-size: 24px;
            font-weight: bold;
        }

        .weather-bottom {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }


    </style>
    <!--wrapper start-->

    <main class="main-content" id="account">
        <!--== Start Page Header Area Wrapper ==-->
        <div class="page-header-area" data-bg-img="{% static 'img/photos/background.jpg' %}">
            <div class="container pt--0 pb--0">
                <div class="row">
                    <div class="col-12">
                        <div class="page-header-content">
                            <h2 class="title">Account</h2>
                            <nav class="breadcrumb-area">
                                <ul class="breadcrumb">
                                    <li><a href="index.html">Home</a></li>
                                    <li class="breadcrumb-sep">//</li>
                                    <li>Account</li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--== End Page Header Area Wrapper ==-->

        <!--== Start My Account Wrapper ==-->
        <section class="my-account-area">
            <div class="container pt--0 pb--0">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="myaccount-page-wrapper">
                            <div class="row">
                                <div class="col-lg-3 col-md-4">
                                    <nav>
                                        <div class="myaccount-tab-menu nav nav-tabs" id="nav-tab" role="tablist">
                                            <button class="nav-link active" id="dashboad-tab" data-bs-toggle="tab"
                                                    data-bs-target="#dashboad" type="button" role="tab"
                                                    aria-controls="dashboad"
                                                    aria-selected="true">Dashboard
                                            </button>

                                            <button class="nav-link" id="account-info-tab" data-bs-toggle="tab"
                                                    data-bs-target="#account-info" type="button" role="tab"
                                                    aria-controls="account-info"
                                                    aria-selected="false">User Info
                                            </button>


                                            <button class="nav-link" id="dogInfo-tab" data-bs-toggle="tab"
                                                    data-bs-target="#dogInfo"
                                                    type="button" role="tab" aria-controls="dogInfo"
                                                    aria-selected="false">Pet Information
                                            </button>

                                            <button class="nav-link" id="orders-tab" data-bs-toggle="tab"
                                                    data-bs-target="#orders"
                                                    type="button" role="tab" aria-controls="orders"
                                                    aria-selected="false">My Orders
                                            </button>

                                            <button class="nav-link" id="schedule-tab" data-bs-toggle="tab"
                                                    data-bs-target="#schedule"
                                                    type="button" role="tab" aria-controls="schedule"
                                                    aria-selected="false"> My Bookings
                                            </button>

                                            <button class="nav-link" id="address-edit-tab" data-bs-toggle="tab"
                                                    data-bs-target="#address-edit" type="button" role="tab"
                                                    aria-controls="address-edit"
                                                    aria-selected="false">address
                                            </button>

                                            <button class="nav-link"
                                                    onclick="window.location.href='/user/logout/'"
                                                    type="button">Logout
                                            </button>
                                        </div>
                                    </nav>
                                </div>
                                <div class="col-lg-9 col-md-8">
                                    <div class="tab-content" id="nav-tabContent">
                                        <div class="tab-pane fade show active" id="dashboad" role="tabpanel"
                                             aria-labelledby="dashboad-tab">
                                            <div class="myaccount-content">
                                                <h3>Dashboard</h3>
                                                <div class="welcome">
                                                    <p>Hello, <strong>{{ request.session.user.username }}</strong> (If
                                                        Not! <a href="/user/logout/" class="logout"> Logout</a>)
                                                    </p>
                                                </div>
                                                <p>From your account dashboard. you can easily check & view your
                                                    recent orders, manage your
                                                    shipping and billing addresses and edit your password and
                                                    account details.</p>
                                                <br>
                                                <div class="weather-dashboard">
                                                    <div class="weather-info-container">
                                                        <h2 class="dashboard-title">Weather</h2>
                                                        <div class="dashboard-meta">
                                                            <span id="currentLocation" class="location"></span>
                                                            <span id="currentDate" class="date"></span>
                                                            <span id="currentTime" class="time"></span>
                                                        </div>
                                                        <div class="weather-top">
                                                            <div class="weather-icon">
                                                                <img id="weatherIcon" src="" alt="Weather Icon">
                                                            </div>
                                                            <div class="weather-main-info">
                                                                <span class="temperature" id="temperature"></span>°C
                                                                <p class="description" id="description"></p>
                                                            </div>
                                                        </div>
                                                        <div class="weather-bottom">
                                                            <div class="wind-info">
                                                                <strong>Wind:</strong> <span id="windSpeed"></span> m/s,
                                                                <span id="windDirection"></span>°
                                                            </div>
                                                            <div class="humidity-info">
                                                                <strong>Humidity:</strong> <span id="humidity"></span>%
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="osmMap"
                                                         style="width:300px;height:300px;margin-left:20px;"></div>
                                                </div>
                                            </div>
                                        </div>

                                        {# 我的订单 #}
                                        <div class="tab-pane fade" id="orders" role="tabpanel"
                                             aria-labelledby="orders-tab">
                                            <div class="myaccount-content">
                                                <h3 class="my_flex">
                                                    <div>Orders (Total: {{ orders.count }})</div>
                                                    <a href="/order">more ></a>
                                                </h3>

                                                <div class="shopping-cart-form table-responsive">
                                                    <table class="table text-center">
                                                        <thead>
                                                        <tr>
                                                            <th>#</th>
                                                            <th>Date</th>
                                                            <th>Price</th>
                                                            <th>Goods Info</th>
                                                            <th>Delivery Info</th>
                                                            <th>Status</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        {% for order_item in orders.list %}
                                                            <tr class="tbody-item">
                                                                <td>
                                                                    {{ forloop.counter }}
                                                                </td>
                                                                <td>{{ order_item.created_at }}</td>
                                                                <td class="my_total_price">
                                                                    ${{ order_item.total_price }}</td>
                                                                <td>
                                                                    <ul>
                                                                        {% for good_item in order_item.goods_info %}
                                                                            <li class="my_li">
                                                                                <img src="{{ good_item.goods.image.url }}"
                                                                                     style="width: 50px;height: 40px;object-fit: cover;margin-right: 4px">
                                                                                <span style="text-decoration: underline;margin-right: 8px">{{ good_item.goods.title }}</span>
                                                                                <span>${{ good_item.goods.price }} x {{ good_item.count }}</span>
                                                                            </li>
                                                                        {% endfor %}
                                                                    </ul>
                                                                </td>
                                                                <td>
                                                                    <div>{{ order_item.delivery_info.name }}</div>
                                                                    <div>{{ order_item.delivery_info.phone }}</div>
                                                                </td>
                                                                <td>{{ order_item.status_display }}</td>
                                                            </tr>
                                                        {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                        {# 宠物信息 显示#}
                                        <div class="tab-pane fade" id="dogInfo" role="tabpanel"
                                             aria-labelledby="dogInfo-tab">
                                            <div class="myaccount-content">
                                                <div>
                                                    <h3 class="my_flex">
                                                        <div>Pet Information</div>
                                                        <div>
                                                            <a href="javascript:void(0)"
                                                               data-bs-toggle="modal" data-bs-target="#addPetModal"
                                                               style="cursor: pointer;color: gray;text-decoration: underline">
                                                                Add
                                                            </a>
                                                        </div>
                                                    </h3>
                                                </div>
                                                <!--== Start Pet Information ==-->
                                                <el-row>
                                                    {% for pet_item in li_pets %}
                                                        <el-col style="margin: 20px;width: 250px">
                                                            <form action="/pet_update/" method="post">
                                                                {% csrf_token %}
                                                                <el-card :body-style="{ padding: '0px'}">
                                                                    <input type="hidden" name="id"
                                                                           value="{{ pet_item.id }}">

                                                                    <img src="{{ pet_item.photo.url }}"
                                                                         style="object-fit: cover;width: 250px;height: 200px"
                                                                         alt="Image-HasTech">

                                                                    <div style="padding: 14px;">

                                                                        <h5 style="font-weight: 600;text-decoration: underline;margin-bottom: 0px">{{ pet_item.name }}</h5>
                                                                        <div class="bottom clearfix">
                                                                            <div>
                                                                                <div style="font-weight: 600">breed:
                                                                                </div>
                                                                                <input type="text" name="breed"
                                                                                       class="form-control"
                                                                                       value="{{ pet_item.breed }}"/>
                                                                            </div>

                                                                            <div>
                                                                                <div style="font-weight: 600">weight:
                                                                                </div>
                                                                                <input type="number" name="weight"
                                                                                       class="form-control"
                                                                                       value="{{ pet_item.weight }}">
                                                                            </div>

                                                                            <div>
                                                                                <div style="font-weight: 600">color:
                                                                                </div>
                                                                                <input type="text" name="hair"
                                                                                       class="form-control"
                                                                                       value="{{ pet_item.hair }}">
                                                                            </div>

                                                                            <div>
                                                                                <div style="font-weight: 600">food
                                                                                    preference:
                                                                                </div>
                                                                                <input type="text"
                                                                                       name="food_preference"
                                                                                       class="form-control"
                                                                                       value="{{ pet_item.food_preference }}">
                                                                            </div>

                                                                            <div>
                                                                                <div style="font-weight: 600">
                                                                                    temperament:
                                                                                </div>
                                                                                <input type="text" name="temperament"
                                                                                       class="form-control"
                                                                                       value="{{ pet_item.temperament }}">
                                                                            </div>

                                                                            <button type="submit" class="my_btn"
                                                                                    style="margin-top: 4px">Update
                                                                            </button>
                                                                        </div>

                                                                    </div>
                                                                </el-card>
                                                            </form>
                                                        </el-col>
                                                    {% endfor %}
                                                </el-row>
                                            </div>
                                        </div>
                                        {# 弹窗-添加 收货信息 模态框#}
                                        <aside class="modal fade" id="addPetModal" tabindex="-1"
                                               aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered">
                                                <div class="modal-content">
                                                    <div class="modal-body" style="padding: 48px 24px;">
                                                        <div>
                                                            <h4>Add Pet</h4>
                                                        </div>
                                                        <hr>
                                                        <div>
                                                            <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal">
                                                                <span class="pe-7s-close"></span>
                                                            </button>
                                                            <div class="container pt--0 pb--0">
                                                                <form action="/pet_add/" method="post"
                                                                      enctype="multipart/form-data">
                                                                    {% csrf_token %}
                                                                    <div class="row">
                                                                        <div class="col-md-12">
                                                                            <div class="form-group">
                                                                                <label for="name">Name</label>
                                                                                <input id="name" name="name" type="text"
                                                                                       class="form-control"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group">
                                                                                <label for="breed">Breed</label>
                                                                                <input id="breed" name="breed"
                                                                                       type="text"
                                                                                       class="form-control"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group">
                                                                                <label for="weight">Body weight</label>
                                                                                <input id="weight" name="weight"
                                                                                       type="number"
                                                                                       class="form-control"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group mb--0">
                                                                                <label for="hair">Color</label>
                                                                                <textarea id="hair" name="hair"
                                                                                          class="form-control"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group mb--0">
                                                                                <label for="food_preference">Food
                                                                                    Preference</label>
                                                                                <textarea id="food_preference"
                                                                                          name="food_preference"
                                                                                          class="form-control"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group mb--0">
                                                                                <label for="temperament">Temperament</label>
                                                                                <textarea id="temperament"
                                                                                          name="temperament"
                                                                                          class="form-control"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group mb--0">
                                                                                <label for="fileSelect">Upload your pet
                                                                                    image:</label>
                                                                                <input type="file" id="fileSelect"
                                                                                       name="photo"
                                                                                       class="form-control">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div>
                                                                        <hr>
                                                                        <button class="my_btn" type="submit">Add
                                                                        </button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </aside>
                                        <!--== End Pet Information ==-->

                                        <div class="tab-pane fade" id="schedule" role="tabpanel"
                                             aria-labelledby="schedule-tab">
                                            <div class="myaccount-content">
                                                <h3 class="my_flex">
                                                    <div>Bookings (Total: {{ bookings.count }})</div>
                                                    <a href="/bookings">more ></a>
                                                </h3>

                                                <div class="shopping-cart-form table-responsive">
                                                    <table class="table text-center">
                                                        <thead>
                                                        <tr>
                                                            <th>#</th>
                                                            <th>Date</th>
                                                            <th>Seller</th>
                                                            <th>Service Info</th>
                                                            <th>Price</th>
                                                            <th>Pet Info</th>
                                                            <th>Status</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        {% for booking_item in bookings.list %}
                                                            <tr class="tbody-item">
                                                                <td>
                                                                    {{ forloop.counter }}
                                                                </td>

                                                                <td>{{ booking_item.created_at }}</td>

                                                                <td>{{ booking_item.seller.username }}</td>

                                                                <td>
                                                                    <ul>
                                                                        <li class="my_li">
                                                                            <img src="{{ booking_item.service_info.image.url }}"
                                                                                 style="width: 50px;height: 40px;object-fit: cover;margin-right: 4px">

                                                                            <span style="text-decoration: underline;margin-right: 8px">{{ booking_item.service_info.title }}</span>

                                                                        </li>
                                                                        <li class="my_li">
                                                                            <span>Category: {{ booking_item.service_info.category_name }}</span>
                                                                        </li>
                                                                        <li class="my_li">
                                                                            <span>Desc: {{ booking_item.service_info.desc }}</span>
                                                                        </li>
                                                                    </ul>
                                                                </td>
                                                                <td class="my_total_price">
                                                                    ${{ booking_item.service_info.price }}</td>
                                                                <td>
                                                                    <ul>
                                                                        <li class="my_li">
                                                                            <img src="{{ booking_item.pet_info.photo.url }}"
                                                                                 style="width: 50px;height: 40px;object-fit: cover;margin-right: 4px">
                                                                        </li>
                                                                        <li class="my_li">
                                                                            {{ booking_item.pet_info.name }}
                                                                        </li>
                                                                    </ul>
                                                                </td>
                                                                <td>{{ booking_item.status_display }}</td>
                                                            </tr>
                                                        {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                        {#                                        <div class="tab-pane fade" id="payment-method" role="tabpanel"#}
                                        {#                                             aria-labelledby="payment-method-tab">#}
                                        {#                                            <div class="myaccount-content">#}
                                        {#                                                <h3>Payment Method</h3>#}
                                        {#                                                <p class="saved-message">You Can't Saved Your Payment Method#}
                                        {#                                                    yet.</p>#}
                                        {#                                            </div>#}
                                        {#                                        </div>#}

                                        <div class="tab-pane fade" id="address-edit" role="tabpanel"
                                             aria-labelledby="address-edit-tab">
                                            <div class="myaccount-content">

                                                <h3 class="my_flex">
                                                    <div>Billing Address</div>
                                                    <div>
                                                        <a href="javascript:void(0)"
                                                           data-bs-toggle="modal" data-bs-target="#addAddrModal"
                                                           style="cursor: pointer;color: gray;text-decoration: underline">
                                                            Add
                                                        </a>
                                                    </div>
                                                </h3>

                                                <div style="display: flex;flex-wrap: wrap">
                                                    {% for addr_item in li_addr %}
                                                        <form action="/delivery_update/" method="post"
                                                              style="margin: 8px;">
                                                            {% csrf_token %}
                                                            <el-card :body-style="{ padding: '14px'}"
                                                                     style="width: 250px">
                                                                <input type="hidden" name="id"
                                                                       value="{{ addr_item.id }}">

                                                                <div>
                                                                    <div style="font-weight: 600">Name:
                                                                    </div>
                                                                    <input type="text" name="name" class="form-control"
                                                                           value="{{ addr_item.name }}"/>
                                                                </div>

                                                                <div>
                                                                    <div style="font-weight: 600">Phone:
                                                                    </div>
                                                                    <input type="text" name="phone" class="form-control"
                                                                           value="{{ addr_item.phone }}"/>
                                                                </div>

                                                                <div>
                                                                    <div style="font-weight: 600">Email:
                                                                    </div>
                                                                    <input type="text" name="email" class="form-control"
                                                                           value="{{ addr_item.email }}"/>
                                                                </div>

                                                                <div>
                                                                    <div style="font-weight: 600">Address:</div>
                                                                    <textarea name="addr"
                                                                              class="form-control">{{ addr_item.addr }}</textarea>
                                                                </div>

                                                                <div>
                                                                    <div style="font-weight: 600">Notes:</div>
                                                                    <textarea name="notes"
                                                                              class="form-control">{{ addr_item.notes }}</textarea>
                                                                </div>

                                                                <hr>
                                                                <input type="submit" value="Update" class="my_btn">
                                                            </el-card>
                                                        </form>
                                                    {% endfor %}
                                                </div>

                                            </div>
                                        </div>
                                        {# 弹窗-添加 收货信息 模态框#}
                                        <aside class="modal fade" id="addAddrModal" tabindex="-1"
                                               aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered">
                                                <div class="modal-content">
                                                    <div class="modal-body" style="padding: 48px 24px;">
                                                        <div>
                                                            <h4>Add Address</h4>
                                                        </div>
                                                        <hr>
                                                        <div>
                                                            <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal">
                                                                <span class="pe-7s-close"></span>
                                                            </button>
                                                            <div class="container pt--0 pb--0">
                                                                <form action="/delivery_add/" method="post"
                                                                      enctype="multipart/form-data">
                                                                    {% csrf_token %}

                                                                    <input type="hidden" name="redirect_page"
                                                                           value="/account/">

                                                                    <div class="row">
                                                                        <div class="col-md-12">
                                                                            <div class="form-group">
                                                                                <label for="name">Name</label>
                                                                                <input id="name" name="name" type="text"
                                                                                       class="form-control"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group">
                                                                                <label for="phone">Phone</label>
                                                                                <input id="phone" name="phone"
                                                                                       type="text"
                                                                                       class="form-control"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group">
                                                                                <label for="email">Email</label>
                                                                                <input id="email" name="email"
                                                                                       type="text"
                                                                                       class="form-control"/>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group mb--0">
                                                                                <label for="addr">Addr</label>
                                                                                <textarea id="addr" name="addr"
                                                                                          class="form-control"
                                                                                          placeholder="Your Address"></textarea>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <div class="form-group mb--0">
                                                                                <label for="notes">Notes</label>
                                                                                <textarea id="notes" name="notes"
                                                                                          class="form-control"
                                                                                          placeholder="Notes about your order"></textarea>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div>
                                                                        <hr>
                                                                        <button class="my_btn" type="submit">Add
                                                                        </button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </aside>

                                        <div class="tab-pane fade" id="account-info" role="tabpanel"
                                             aria-labelledby="account-info-tab">
                                            <div class="myaccount-content">
                                                <h3>User Info</h3>
                                                <div class="account-details-form">
                                                    <form action="/user_update/" method="post">
                                                        {% csrf_token %}
                                                        <div class="row">
                                                            <div class="col-12" style="margin-bottom: 8px">
                                                                <div class="form-group">
                                                                    <label for="username">Username <span
                                                                            class="required">*</span></label>
                                                                    <input id="username" class="form-control"
                                                                           value="{{ request.session.user.username }}"
                                                                           type="email" disabled>
                                                                </div>
                                                            </div>

                                                            <div class="col-12" style="margin-bottom: 8px">
                                                                <div class="form-group">
                                                                    <label for="email">Email address <span
                                                                            class="required">*</span></label>
                                                                    <input id="email" name="email" class="form-control"
                                                                           value="{{ request.session.user.email }}"
                                                                           type="email">
                                                                </div>
                                                            </div>

                                                            <div class="col-12" style="margin-bottom: 8px">
                                                                <div class="form-group">
                                                                    <label for="age">Phone number<span
                                                                            class="required">*</span></label>
                                                                    <input id="age" name="age" class="form-control"
                                                                           value="{{ request.session.user.age }}"
                                                                           type="number">
                                                                </div>
                                                            </div>

                                                            <div class="col-12" style="margin-bottom: 8px">
                                                                <div class="form-group">
                                                                    <label for="password">Password (left blank when not
                                                                        modified)</label>
                                                                    <input id="password" name="password"
                                                                           class="form-control"
                                                                           value=""
                                                                           type="password">
                                                                </div>
                                                            </div>

                                                            <div class="col-12" style="margin-bottom: 8px">
                                                                <div class="form-group">
                                                                    <label for="ck_password">Confirm Password (left blank when not
                                                                        modified)</label>
                                                                    <input id="ck_password" name="ck_password"
                                                                           class="form-control"
                                                                           value=""
                                                                           type="password">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="single-input-item">
                                                            {#                                                            <button class="check-btn sqr-btn">Upadte</button>#}
                                                            <button class="my_btn">Update</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--== End My Account Wrapper ==-->

    </main>


    <script type="text/javascript">
        new Vue({
            el: "#account",
            methods: {
                gopath() {
                    window.open('add-schedules.html')
                }
            },
        });
    </script>

{% endblock content %}